<!DOCTYPE html> <html lang="zh-CN" class="h-full"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>CoreDNS 完全指南 | 架构、功能与最佳实践</title> <meta name="description" content="深入解析CoreDNS的核心架构、功能特性以及在Kubernetes环境中的最佳实践"> <script src="https://cdn.tailwindcss.com/3.4.1"></script> <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: "#fdf9f7",
                            100: "#f4e7e1",
                            200: "#e9d4c9",
                            300: "#dab7a5",
                            400: "#c8896a",
                            500: "#c16a3e",
                            600: "#a0532d",
                            700: "#904722",
                            800: "#773818",
                            900: "#552811"
                        },
                        secondary: {
                            50: "#ffffff",
                            100: "#ffffff",
                            200: "#ebf4ea",
                            300: "#cce3c8",
                            400: "#9bcd91",
                            500: "#78c269",
                            600: "#55b741",
                            700: "#49a935",
                            800: "#3a9328",
                            900: "#2d731f"
                        },
                        neutral: {
                            50: "#ffffff",
                            100: "#ffffff",
                            200: "#ffffff",
                            300: "#ffffff",
                            400: "#f3f3f2",
                            500: "#ddd9d5",
                            600: "#c9c0b6",
                            700: "#c2b3a3",
                            800: "#b9a189",
                            900: "#aa8c6f"
                        }
                    },
                    fontFamily: {
                        sans: ['Inter var', 'system-ui', '-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial', 'Noto Sans', 'sans-serif', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'],
                        serif: ['Georgia', 'Cambria', '"Times New Roman"', 'Times', 'serif']
                    },
                    borderRadius: {
                        'xl': '10px'
                    }
                }
            },
            darkMode: 'class'
        }
    </script> <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script> <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            fontFamily: 'inherit'
        });
    </script> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"> <style>@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');body{font-family:'Inter',sans-serif;line-height:1.6;@apply bg-neutral-50 dark:bg-neutral-900 text-neutral-800 dark:text-neutral-200}.prose{max-width:65ch}.card{@apply bg-white dark:bg-neutral-800 rounded-xl shadow-md overflow-hidden transition-all duration-200 hover:shadow-lg hover:-translate-y-0.5}.code-block{@apply bg-neutral-100 dark:bg-neutral-700 rounded-lg p-4 overflow-x-auto text-sm;font-family:'Menlo','Monaco','Consolas','Liberation Mono','Courier New',monospace}.table-container{@apply overflow-x-auto rounded-lg border border-neutral-200 dark:border-neutral-700}table{@apply w-full}th{@apply bg-neutral-100 dark:bg-neutral-800 text-left px-4 py-3 font-medium}td{@apply border-t border-neutral-200 dark:border-neutral-700 px-4 py-3}tr:hover td{@apply bg-neutral-50 dark:bg-neutral-700}.btn{@apply inline-flex items-center justify-center px-4 py-2 rounded-xl font-medium transition-all duration-200}.btn-primary{@apply bg-primary-600 hover:bg-primary-700 text-white}.btn-secondary{@apply bg-secondary-600 hover:bg-secondary-700 text-white}.dark-mode-toggle{@apply fixed bottom-6 right-6 z-50 w-12 h-12 rounded-full bg-primary-600 hover:bg-primary-700 text-white flex items-center justify-center shadow-lg cursor-pointer transition-all duration-200 hover:scale-110}.section{@apply py-12 px-4 sm:px-6 lg:px-8 max-w-6xl mx-auto}.section-title{@apply text-3xl font-bold mb-8 text-primary-700 dark:text-primary-500}.subsection-title{@apply text-2xl font-semibold mt-8 mb-4 text-primary-600 dark:text-primary-400}.feature-icon{@apply w-10 h-10 rounded-full bg-primary-100 dark:bg-primary-900 text-primary-600 dark:text-primary-300 flex items-center justify-center mb-4}.animate-fade-in{animation:fadeIn .5s ease-in-out}@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}</style> </head> <body class="h-full"> <header class="bg-white dark:bg-neutral-800 shadow-sm"> <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"> <div class="flex justify-between items-center"> <div class="flex items-center space-x-4"> <div class="w-10 h-10 rounded-lg bg-primary-600 flex items-center justify-center text-white"> <i class="fas fa-server text-xl"></i> </div> <h1 class="text-2xl font-bold text-primary-700 dark:text-primary-400">CoreDNS 完全指南</h1> </div> <nav class="hidden md:flex space-x-8"> <a href="#architecture" class="text-neutral-600 dark:text-neutral-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">架构</a> <a href="#features" class="text-neutral-600 dark:text-neutral-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">功能</a> <a href="#kubernetes" class="text-neutral-600 dark:text-neutral-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Kubernetes</a> <a href="#best-practices" class="text-neutral-600 dark:text-neutral-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">最佳实践</a> </nav> <button class="md:hidden text-neutral-600 dark:text-neutral-300"> <i class="fas fa-bars text-xl"></i> </button> </div> </div> </header> <section class="bg-gradient-to-r from-primary-50 to-secondary-50 dark:from-neutral-800 dark:to-neutral-800 py-16"> <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-center"> <h1 class="text-4xl md:text-5xl font-bold text-primary-800 dark:text-primary-300 mb-6 animate-fade-in">CoreDNS 完全指南</h1> <p class="text-xl text-neutral-600 dark:text-neutral-300 max-w-3xl mx-auto mb-8 animate-fade-in">深入解析 CoreDNS 的核心架构、功能特性以及在 Kubernetes 环境中的最佳实践</p> <div class="flex flex-col sm:flex-row justify-center gap-4 animate-fade-in"> <a href="#architecture" class="btn btn-primary"> <i class="fas fa-layer-group mr-2"></i> 了解架构 </a> <a href="#kubernetes" class="btn btn-secondary"> <i class="fab fa-kubernetes mr-2"></i> Kubernetes 集成 </a> </div> </div> </section> <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12"> <section id="architecture" class="section"> <h2 class="section-title">1. CoreDNS 基础架构与功能</h2> <div class="grid md:grid-cols-2 gap-8 mb-12"> <div class="card p-6"> <div class="feature-icon"> <i class="fas fa-puzzle-piece"></i> </div> <h3 class="text-xl font-semibold mb-3 text-primary-700 dark:text-primary-400">模块化插件机制</h3> <p class="text-neutral-600 dark:text-neutral-300">CoreDNS 通过插件架构实现功能扩展，每个插件实现特定功能（如缓存、转发、日志），通过 <strong>Corefile</strong> 配置文件动态组合插件链。</p> </div> <div class="card p-6"> <div class="feature-icon"> <i class="fas fa-network-wired"></i> </div> <h3 class="text-xl font-semibold mb-3 text-primary-700 dark:text-primary-400">多协议支持</h3> <ul class="list-disc pl-5 space-y-1 text-neutral-600 dark:text-neutral-300"> <li>DNS (UDP/TCP)</li> <li>DNS-over-TLS (DoT)</li> <li>DNS-over-HTTPS (DoH)</li> <li>gRPC 协议</li> </ul> </div> </div> <h3 class="subsection-title">Kubernetes 集成优势</h3> <div class="grid md:grid-cols-3 gap-6 mb-8"> <div class="card p-5"> <div class="flex items-center mb-2"> <div class="w-8 h-8 rounded-full bg-secondary-100 dark:bg-secondary-900 text-secondary-600 dark:text-secondary-300 flex items-center justify-center mr-3"> <i class="fas fa-sync-alt"></i> </div> <h4 class="font-medium">自动同步</h4> </div> <p class="text-sm text-neutral-600 dark:text-neutral-300">自动同步 Kubernetes Service/Endpoint 变化</p> </div> <div class="card p-5"> <div class="flex items-center mb-2"> <div class="w-8 h-8 rounded-full bg-secondary-100 dark:bg-secondary-900 text-secondary-600 dark:text-secondary-300 flex items-center justify-center mr-3"> <i class="fas fa-search"></i> </div> <h4 class="font-medium">服务发现</h4> </div> <p class="text-sm text-neutral-600 dark:text-neutral-300">支持 <code>cluster.local</code> 域名的服务发现</p> </div> <div class="card p-5"> <div class="flex items-center mb-2"> <div class="w-8 h-8 rounded-full bg-secondary-100 dark:bg-secondary-900 text-secondary-600 dark:text-secondary-300 flex items-center justify-center mr-3"> <i class="fas fa-route"></i> </div> <h4 class="font-medium">路径优化</h4> </div> <p class="text-sm text-neutral-600 dark:text-neutral-300">通过 <strong>autopath</strong> 插件优化 DNS 解析路径</p> </div> </div> <h3 class="subsection-title">场景对比</h3> <div class="table-container mb-8"> <table> <thead> <tr> <th>维度</th> <th>云原生环境</th> <th>传统 DNS 场景</th> </tr> </thead> <tbody> <tr> <td>配置更新频率</td> <td>动态（秒级）</td> <td>静态（人工修改）</td> </tr> <tr> <td>服务发现</td> <td>自动关联 Pod/Service</td> <td>手动维护记录</td> </tr> <tr> <td>扩展性</td> <td>插件灵活组合</td> <td>功能固化</td> </tr> </tbody> </table> </div> <h3 class="subsection-title">工作原理与插件链</h3> <div class="grid md:grid-cols-2 gap-8 mb-8"> <div> <div class="mermaid mb-6"> graph TD A[DNS请求] --&gt; B{插件链处理} B --&gt;|1. 日志记录| C[log插件] B --&gt;|2. 缓存查询| D[cache插件] B --&gt;|3. 转发请求| E[forward插件] E --&gt; F[上游DNS服务器] </div> </div> <div> <h4 class="font-semibold mb-3 text-primary-600 dark:text-primary-400">插件顺序重要性</h4> <p class="mb-4 text-neutral-600 dark:text-neutral-300"><strong>执行顺序决定处理逻辑</strong>：例如 <code>cache</code> 插件在前会直接响应缓存结果，若在 <code>forward</code> 后则缓存远程响应</p> <h4 class="font-semibold mb-3 text-primary-600 dark:text-primary-400">配置示例</h4> <div class="code-block mb-4"> <pre><code>.:53 {
    # 日志记录插件
    log
    # 缓存 30 秒，排除 .nocache. 域名
    cache 30 {
        success 1024
        denial 512
        prefetch 10 30%
    }
    # 转发到 Google DNS
    forward . 8.8.8.8 8.8.4.4
}</code></pre> </div> </div> </div> </section> <section id="comparison" class="section bg-neutral-50 dark:bg-neutral-800/50 rounded-xl"> <h2 class="section-title">2. CoreDNS vs KubeDNS</h2> <h3 class="subsection-title">对比表</h3> <div class="table-container mb-8"> <table> <thead> <tr> <th>维度</th> <th>CoreDNS</th> <th>KubeDNS</th> </tr> </thead> <tbody> <tr> <td>架构</td> <td>单进程+插件链</td> <td>多组件（kube-dns+sidecar）</td> </tr> <tr> <td>性能</td> <td>更高 QPS（减少上下文切换）</td> <td>较低</td> </tr> <tr> <td>扩展性</td> <td>支持 70+ 插件</td> <td>无插件机制</td> </tr> <tr> <td>协议支持</td> <td>DoT/DoH/EDNS0</td> <td>仅基础 DNS</td> </tr> <tr> <td>维护状态</td> <td>活跃开发</td> <td>已弃用</td> </tr> </tbody> </table> </div> <h3 class="subsection-title">KubeDNS 被替代原因</h3> <div class="grid md:grid-cols-3 gap-6 mb-8"> <div class="card p-5"> <div class="flex items-center mb-2"> <div class="w-8 h-8 rounded-full bg-primary-100 dark:bg-primary-900 text-primary-600 dark:text-primary-300 flex items-center justify-center mr-3"> <i class="fas fa-tachometer-alt"></i> </div> <h4 class="font-medium">性能瓶颈</h4> </div> <p class="text-sm text-neutral-600 dark:text-neutral-300">多组件架构导致性能瓶颈</p> </div> <div class="card p-5"> <div class="flex items-center mb-2"> <div class="w-8 h-8 rounded-full bg-primary-100 dark:bg-primary-900 text-primary-600 dark:text-primary-300 flex items-center justify-center mr-3"> <i class="fas fa-expand"></i> </div> <h4 class="font-medium">扩展性不足</h4> </div> <p class="text-sm text-neutral-600 dark:text-neutral-300">缺乏动态扩展能力</p> </div> <div class="card p-5"> <div class="flex items-center mb-2"> <div class="w-8 h-8 rounded-full bg-primary-100 dark:bg-primary-900 text-primary-600 dark:text-primary-300 flex items-center justify-center mr-3"> <i class="fas fa-users"></i> </div> <h4 class="font-medium">社区支持</h4> </div> <p class="text-sm text-neutral-600 dark:text-neutral-300">社区支持转向 CoreDNS</p> </div> </div> <h3 class="subsection-title">默认配置验证</h3> <div class="code-block mb-4"> <pre><code>kubectl get deployment -n kube-system coredns</code></pre> </div> </section> <section id="kubernetes" class="section"> <h2 class="section-title">3. Kubernetes 部署与配置</h2> <h3 class="subsection-title">Helm 部署命令</h3> <div class="code-block mb-6"> <pre><code>helm install coredns stable/coredns \
  --namespace kube-system \
  --set service.clusterIP=10.96.0.10</code></pre> </div> <h3 class="subsection-title">验证方法</h3> <div class="grid md:grid-cols-3 gap-6 mb-8"> <div class="card p-5"> <h4 class="font-medium mb-2 text-primary-600 dark:text-primary-400">端点检查</h4> <div class="code-block"> <pre><code>kubectl get endpoints coredns -n kube-system</code></pre> </div> </div> <div class="card p-5"> <h4 class="font-medium mb-2 text-primary-600 dark:text-primary-400">解析测试</h4> <div class="code-block"> <pre><code>kubectl run -it --rm test --image=busybox --restart=Never -- nslookup kubernetes.default</code></pre> </div> </div> <div class="card p-5"> <h4 class="font-medium mb-2 text-primary-600 dark:text-primary-400">日志查看</h4> <div class="code-block"> <pre><code>kubectl logs -l k8s-app=coredns -n kube-system</code></pre> </div> </div> </div> <h3 class="subsection-title">配置更新流程</h3> <div class="code-block mb-6"> <pre><code>kubectl edit configmap coredns -n kube-system
# 修改后等待 30 秒自动热更新</code></pre> </div> <h3 class="subsection-title">复杂配置示例</h3> <div class="grid md:grid-cols-2 gap-8 mb-8"> <div> <div class="code-block mb-4"> <pre><code>example.com:53 {
    # 固定 IP 解析
    hosts {
        192.168.1.100 example.com
        fallthrough
    }
}

.:53 {
    # Kubernetes 服务发现
    kubernetes cluster.local {
        pods insecure
        upstream
    }
    # 缓存策略
    cache 300 {
        exclude "*.nocache.example.com"
    }
}</code></pre> </div> </div> <div> <h4 class="font-semibold mb-3 text-primary-600 dark:text-primary-400">验证命令</h4> <div class="code-block mb-4"> <pre><code>dig @&lt;CoreDNS_IP&gt; example.com A
dig @&lt;CoreDNS_IP&gt; kubernetes.default.svc.cluster.local A</code></pre> </div> </div> </div> <h3 class="subsection-title">服务发现机制</h3> <div class="mermaid mb-8"> sequenceDiagram Client-&gt;&gt;CoreDNS: 查询 service.ns.svc.cluster.local CoreDNS-&gt;&gt;API Server: Watch Service/Endpoint API Server--&gt;&gt;CoreDNS: 推送变更事件 CoreDNS-&gt;&gt;Client: 返回解析结果 </div> <h4 class="font-semibold mb-3 text-primary-600 dark:text-primary-400">Headless Service 处理</h4> <ul class="list-disc pl-5 space-y-1 mb-6 text-neutral-600 dark:text-neutral-300"> <li>直接返回所有 Pod IP（无 ClusterIP）</li> <li>通过 <code>SRV</code> 记录提供端口信息</li> </ul> <h3 class="subsection-title">跨 Namespace 转发</h3> <div class="grid md:grid-cols-2 gap-8 mb-8"> <div> <div class="code-block mb-4"> <pre><code>namespace-a.svc.cluster.local {
    rewrite name substring namespace-a.svc.cluster.local namespace-b.svc.cluster.local
    forward . /etc/resolv.conf
    errors
}</code></pre> </div> </div> <div> <h4 class="font-semibold mb-3 text-primary-600 dark:text-primary-400">验证命令</h4> <div class="code-block mb-4"> <pre><code>curl http://service.namespace-a.svc.cluster.local</code></pre> </div> </div> </div> </section> <section id="best-practices" class="section bg-neutral-50 dark:bg-neutral-800/50 rounded-xl"> <h2 class="section-title">4. 最佳实践与问题排查</h2> <h3 class="subsection-title">转发规则注意事项</h3> <div class="table-container mb-8"> <table> <thead> <tr> <th>问题描述</th> <th>解决方案</th> <th>配置示例</th> </tr> </thead> <tbody> <tr> <td>上游服务器不可达</td> <td>多备份服务器配置</td> <td><code>forward . 1.1.1.1 9.9.9.9</code></td> </tr> <tr> <td>未加密通信风险</td> <td>启用 DoT</td> <td><code>forward . tls://8.8.8.8</code></td> </tr> <tr> <td>缓存污染</td> <td>设置合理 TTL</td> <td><code>cache 60</code></td> </tr> </tbody> </table> </div> <h3 class="subsection-title">配置验证方法</h3> <div class="grid md:grid-cols-3 gap-6 mb-8"> <div class="card p-5"> <h4 class="font-medium mb-2 text-primary-600 dark:text-primary-400">Busybox 测试</h4> <div class="code-block"> <pre><code>kubectl exec -it busybox -- nslookup service.namespace</code></pre> </div> </div> <div class="card p-5"> <h4 class="font-medium mb-2 text-primary-600 dark:text-primary-400">日志分析</h4> <div class="code-block"> <pre><code>[INFO] 10.244.0.12:4321 - 38712 "A IN service.ns.svc.cluster.local."</code></pre> </div> </div> <div class="card p-5"> <h4 class="font-medium mb-2 text-primary-600 dark:text-primary-400">Prometheus 指标</h4> <div class="code-block"> <pre><code>coredns_dns_request_count_total{zone="cluster.local"}</code></pre> </div> </div> </div> <h3 class="subsection-title">插件开发基础</h3> <div class="grid md:grid-cols-2 gap-8 mb-8"> <div> <h4 class="font-semibold mb-3 text-primary-600 dark:text-primary-400">必要接口</h4> <ol class="list-decimal pl-5 space-y-1 mb-4 text-neutral-600 dark:text-neutral-300"> <li> <strong><code>ServeDNS</code></strong>：处理 DNS 请求</li> <li> <strong><code>Name</code></strong>：返回插件名称</li> </ol> </div> <div> <h4 class="font-semibold mb-3 text-primary-600 dark:text-primary-400">代码框架</h4> <div class="code-block mb-4"> <pre><code>package main

type MyPlugin struct{}

func (p MyPlugin) ServeDNS(ctx context.Context, w dns.ResponseWriter, r *dns.Msg) (int, error) {
    // 重写逻辑
    return dns.NextPluginSuccess
}

func (p MyPlugin) Name() string { return "myplugin" }</code></pre> </div> </div> </div> <h3 class="subsection-title">最佳实践总结</h3> <div class="grid md:grid-cols-3 gap-6 mb-8"> <div class="card p-5"> <div class="flex items-center mb-2"> <div class="w-8 h-8 rounded-full bg-secondary-100 dark:bg-secondary-900 text-secondary-600 dark:text-secondary-300 flex items-center justify-center mr-3"> <i class="fas fa-plug"></i> </div> <h4 class="font-medium">插件精简</h4> </div> <p class="text-sm text-neutral-600 dark:text-neutral-300">仅启用必要插件以减少资源消耗</p> </div> <div class="card p-5"> <div class="flex items-center mb-2"> <div class="w-8 h-8 rounded-full bg-secondary-100 dark:bg-secondary-900 text-secondary-600 dark:text-secondary-300 flex items-center justify-center mr-3"> <i class="fas fa-chart-line"></i> </div> <h4 class="font-medium">监控告警</h4> </div> <p class="text-sm text-neutral-600 dark:text-neutral-300">监控 <code>coredns_dns_response_rcode_count</code> 指标</p> </div> <div class="card p-5"> <div class="flex items-center mb-2"> <div class="w-8 h-8 rounded-full bg-secondary-100 dark:bg-secondary-900 text-secondary-600 dark:text-secondary-300 flex items-center justify-center mr-3"> <i class="fas fa-lock"></i> </div> <h4 class="font-medium">安全加固</h4> </div> <p class="text-sm text-neutral-600 dark:text-neutral-300">启用 DoT/DoH 防止 DNS 劫持</p> </div> </div> <h3 class="subsection-title">常见问题排查清单</h3> <div class="grid md:grid-cols-3 gap-6"> <div class="card p-5"> <div class="flex items-center mb-2"> <div class="w-8 h-8 rounded-full bg-primary-100 dark:bg-primary-900 text-primary-600 dark:text-primary-300 flex items-center justify-center mr-3"> <i class="fas fa-clock"></i> </div> <h4 class="font-medium">解析超时</h4> </div> <p class="text-sm text-neutral-600 dark:text-neutral-300">检查上游 DNS 可达性</p> </div> <div class="card p-5"> <div class="flex items-center mb-2"> <div class="w-8 h-8 rounded-full bg-primary-100 dark:bg-primary-900 text-primary-600 dark:text-primary-300 flex items-center justify-center mr-3"> <i class="fas fa-exclamation-triangle"></i> </div> <h4 class="font-medium">NXDOMAIN 错误</h4> </div> <p class="text-sm text-neutral-600 dark:text-neutral-300">验证 Service 标签匹配</p> </div> <div class="card p-5"> <div class="flex items-center mb-2"> <div class="w-8 h-8 rounded-full bg-primary-100 dark:bg-primary-900 text-primary-600 dark:text-primary-300 flex items-center justify-center mr-3"> <i class="fas fa-comment-slash"></i> </div> <h4 class="font-medium">日志无输出</h4> </div> <p class="text-sm text-neutral-600 dark:text-neutral-300">检查 <code>log</code> 插件是否加载</p> </div> </div> </section> </main> <footer class="bg-neutral-100 dark:bg-neutral-800 py-12"> <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"> <div class="grid md:grid-cols-2 gap-8"> <div> <h3 class="text-lg font-semibold mb-4 text-primary-700 dark:text-primary-400">关于本指南</h3> <p class="text-neutral-600 dark:text-neutral-300 mb-4">本指南全面介绍了 CoreDNS 的核心架构、功能特性以及在 Kubernetes 环境中的最佳实践，帮助您更好地理解和使用 CoreDNS。</p> </div> <div> <h3 class="text-lg font-semibold mb-4 text-primary-700 dark:text-primary-400">作者信息</h3> <div class="flex items-center mb-3"> <div class="w-10 h-10 rounded-full bg-primary-100 dark:bg-primary-900 text-primary-600 dark:text-primary-300 flex items-center justify-center mr-3"> <i class="fas fa-user"></i> </div> <div> <p class="font-medium">Richie</p> <p class="text-sm text-neutral-500 dark:text-neutral-400">CoreDNS 专家</p> </div> </div> <div class="flex space-x-4"> <a href="#" class="text-neutral-600 dark:text-neutral-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors"> <i class="fab fa-twitter text-xl"></i> </a> <a href="#" class="text-neutral-600 dark:text-neutral-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors"> <i class="fab fa-github text-xl"></i> </a> </div> </div> </div> <div class="border-t border-neutral-200 dark:border-neutral-700 mt-8 pt-8 text-center text-neutral-500 dark:text-neutral-400"> <p>© 2025 Richie. 保留所有权利。</p> </div> </div> </footer> <div id="darkModeToggle" class="dark-mode-toggle"> <i class="fas fa-moon dark:hidden"></i> <i class="fas fa-sun hidden dark:block"></i> </div> <script>
        // Dark mode toggle
        const darkModeToggle = document.getElementById('darkModeToggle');
        const html = document.documentElement;
        
        // Check for saved user preference or use system preference
        const userPref = localStorage.getItem('theme');
        const systemPref = window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        if (userPref === 'dark' || (!userPref && systemPref)) {
            html.classList.add('dark');
        }
        
        darkModeToggle.addEventListener('click', () => {
            html.classList.toggle('dark');
            localStorage.setItem('theme', html.classList.contains('dark') ? 'dark' : 'light');
        });
        
        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                
                const targetId = this.getAttribute('href');
                const targetElement = document.querySelector(targetId);
                
                if (targetElement) {
                    targetElement.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
        
        // Animation on scroll
        const animateOnScroll = () => {
            const elements = document.querySelectorAll('.card, .section-title, .subsection-title');
            
            elements.forEach(element => {
                const elementPosition = element.getBoundingClientRect().top;
                const windowHeight = window.innerHeight;
                
                if (elementPosition < windowHeight - 100) {
                    element.classList.add('animate-fade-in');
                }
            });
        };
        
        window.addEventListener('scroll', animateOnScroll);
        window.addEventListener('load', animateOnScroll);
    </script> </body> </html>